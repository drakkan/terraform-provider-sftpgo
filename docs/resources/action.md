---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "sftpgo_action Resource - sftpgo"
subcategory: ""
description: |-
  Event action
---

# sftpgo_action (Resource)

Event action



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Unique name.
- `type` (Number) Action type.

Supported values:
* `1`: HTTP
* `2`: Command
* `3`: Email
* `4`: Backup
* `5`: User quota reset
* `6`: Folder quota reset
* `7`: Transfer quota reset
* `8`: Data retention check
* `9`: Filesystem
* `11`: Password expiration check
* `12`: User expiration check
* `13`: Identity Provider account check
* `14`: User inactivity check
* `15`: Rotate log file
* `16`: IMAP
* `17`: ICAP
* `18`: Share expiration check

### Optional

- `description` (String) Optional description.
- `options` (Attributes) Configuration options specific for the action type. (see [below for nested schema](#nestedatt--options))

### Read-Only

- `id` (String) Required to use the test framework. Matches the action name.

<a id="nestedatt--options"></a>
### Nested Schema for `options`

Optional:

- `cmd_config` (Attributes) External command action configurations. (see [below for nested schema](#nestedatt--options--cmd_config))
- `email_config` (Attributes) Email action configurations. (see [below for nested schema](#nestedatt--options--email_config))
- `fs_config` (Attributes) Filesystem action configurations. (see [below for nested schema](#nestedatt--options--fs_config))
- `http_config` (Attributes) HTTP action configurations. (see [below for nested schema](#nestedatt--options--http_config))
- `icap_config` (Attributes) Enables integration with ICAP servers to perform antivirus scanning and DLP checks. Available in the Enterprise edition (see [below for nested schema](#nestedatt--options--icap_config))
- `idp_config` (Attributes) Identity Provider account check action configurations. (see [below for nested schema](#nestedatt--options--idp_config))
- `imap_config` (Attributes) Enables automatic retrieval of email attachments from IMAP mailboxes. Available in the Enterprise edition (see [below for nested schema](#nestedatt--options--imap_config))
- `pwd_expiration_config` (Attributes) Password expiration action configurations. (see [below for nested schema](#nestedatt--options--pwd_expiration_config))
- `retention_config` (Attributes) Data retention action configurations. (see [below for nested schema](#nestedatt--options--retention_config))
- `share_expiration_config` (Attributes) Automated lifecycle management for shares based on inactivity, expiration, or max tokens. Available in the Enterprise edition (see [below for nested schema](#nestedatt--options--share_expiration_config))
- `user_inactivity_config` (Attributes) User inactivity check configurations. (see [below for nested schema](#nestedatt--options--user_inactivity_config))

<a id="nestedatt--options--cmd_config"></a>
### Nested Schema for `options.cmd_config`

Required:

- `cmd` (String) Absolute path to the command to execute.
- `timeout` (Number) Time limit for the command in seconds.

Optional:

- `args` (List of String) Command line arguments.
- `env_vars` (Attributes List) Environment variables to set for the external command. (see [below for nested schema](#nestedatt--options--cmd_config--env_vars))

<a id="nestedatt--options--cmd_config--env_vars"></a>
### Nested Schema for `options.cmd_config.env_vars`

Required:

- `key` (String)
- `value` (String)



<a id="nestedatt--options--email_config"></a>
### Nested Schema for `options.email_config`

Required:

- `body` (String)
- `recipients` (List of String)
- `subject` (String)

Optional:

- `attachments` (List of String) Paths to attach. The total size is limited to 10 MB.
- `bcc` (List of String)
- `content_type` (Number) Optional content type. 0 means text/plain, 1 means text/html. If omitted, text/plain is assumed.


<a id="nestedatt--options--fs_config"></a>
### Nested Schema for `options.fs_config`

Required:

- `type` (Number) 1 = Rename, 2 = Delete, 3 = Mkdir, 4 = Exist, 5 = Compress, 6 = Copy, 7 = PGP (Available in the Enterprise edition), 8 Metadata Check (Available in the Enterprise edition), 9 Decompress (Available in the Enterprise edition).

Optional:

- `compress` (Attributes) Configuration for paths to compress as zip. (see [below for nested schema](#nestedatt--options--fs_config--compress))
- `copy` (Attributes List) Paths to copy. The key is the source path, the value is the target. (see [below for nested schema](#nestedatt--options--fs_config--copy))
- `decompress` (Attributes) Configuration for archive to extract. Available in the Enterprise edition (see [below for nested schema](#nestedatt--options--fs_config--decompress))
- `deletes` (List of String) Paths to delete.
- `exist` (List of String) Paths to check for existence.
- `folder` (String) Actions triggered by filesystem events, such as uploads or downloads, use the filesystem associated with the user. By specifying a folder, you can control which filesystem is used. This is especially useful for events that aren't tied to a user, such as scheduled tasks and advanced workflows. Available in the Enterprise edition.
- `metadata_check` (Attributes) This action verifies whether the metadata key matches the configured value or is absent for the specified path. Optionally, it can retry periodically until the specified timeout (in seconds) is reached. Available in the Enterprise edition. (see [below for nested schema](#nestedatt--options--fs_config--metadata_check))
- `mkdirs` (List of String) Directories paths to create.
- `pgp` (Attributes) Configuration for PGP actions. Either a password or a key pair is required. For encryption, the public key is required, and the private, if provided, will be used for signing. For decryption, the private key is required, and the public key, if provided, will be used for signature verification. Available in the Enterprise edition. (see [below for nested schema](#nestedatt--options--fs_config--pgp))
- `renames` (Attributes List) Paths to rename. The key is the source path, the value is the target. (see [below for nested schema](#nestedatt--options--fs_config--renames))
- `target_folder` (String) By specifying a target folder, you can use a different filesystem for target paths than the one associated with the user who triggered the action. This is useful for moving files to another storage backend, such as a different S3 bucket or an external SFTP server, accessing restricted areas of the same storage backend, supporting scheduled actions, or enabling more advanced workflows. Available in the Enterprise edition.

<a id="nestedatt--options--fs_config--compress"></a>
### Nested Schema for `options.fs_config.compress`

Required:

- `name` (String) Full path to the zip file.
- `paths` (List of String) Paths to include in the compressed archive.


<a id="nestedatt--options--fs_config--copy"></a>
### Nested Schema for `options.fs_config.copy`

Required:

- `key` (String)
- `value` (String)


<a id="nestedatt--options--fs_config--decompress"></a>
### Nested Schema for `options.fs_config.decompress`

Required:

- `extract_dir` (String) Directory to extract the archive into.
- `name` (String) Full path to the zip file.


<a id="nestedatt--options--fs_config--metadata_check"></a>
### Nested Schema for `options.fs_config.metadata_check`

Required:

- `metadata` (Attributes) (see [below for nested schema](#nestedatt--options--fs_config--metadata_check--metadata))
- `path` (String)

Optional:

- `timeout` (Number)

<a id="nestedatt--options--fs_config--metadata_check--metadata"></a>
### Nested Schema for `options.fs_config.metadata_check.metadata`

Required:

- `key` (String)

Optional:

- `value` (String)



<a id="nestedatt--options--fs_config--pgp"></a>
### Nested Schema for `options.fs_config.pgp`

Required:

- `mode` (Number) 1 = Encrypt, 2 = Decrypt.
- `paths` (Attributes List) Paths to encrypt or decrypt. (see [below for nested schema](#nestedatt--options--fs_config--pgp--paths))

Optional:

- `passphrase` (String, Sensitive) SFTPGo secret formatted as string: "$<status>$<key>$<additional data length>$<additional data><payload>".
- `password` (String, Sensitive) SFTPGo secret formatted as string: "$<status>$<key>$<additional data length>$<additional data><payload>".
- `private_key` (String, Sensitive) SFTPGo secret formatted as string: "$<status>$<key>$<additional data length>$<additional data><payload>".
- `profile` (Number) Algorithms to use. 0 = Default (widely implemented algorithms), 1 = RFC 4880, 2 = RFC 9580. Don't set to use the default.
- `public_key` (String)

<a id="nestedatt--options--fs_config--pgp--paths"></a>
### Nested Schema for `options.fs_config.pgp.paths`

Required:

- `key` (String)
- `value` (String)



<a id="nestedatt--options--fs_config--renames"></a>
### Nested Schema for `options.fs_config.renames`

Required:

- `key` (String)
- `value` (String)

Optional:

- `update_modtime` (Boolean) Update modification time. This setting is not recursive and only applies to storage providers that support changing modification times.



<a id="nestedatt--options--http_config"></a>
### Nested Schema for `options.http_config`

Required:

- `endpoint` (String) HTTP endpoint to invoke.
- `method` (String) HTTP method.

Optional:

- `body` (String) Request body for POST/PUT.
- `headers` (Attributes List) Headers to add to the HTTP request. (see [below for nested schema](#nestedatt--options--http_config--headers))
- `parts` (Attributes List) Multipart requests allow to combine one or more sets of data into a single body. For each part, you can set a file path or a body as text. Placeholders are supported in file path, body, header values. (see [below for nested schema](#nestedatt--options--http_config--parts))
- `password` (String, Sensitive) SFTPGo secret formatted as string: "$<status>$<key>$<additional data length>$<additional data><payload>".
- `query_parameters` (Attributes List) Query parameters to add to the HTTP request. (see [below for nested schema](#nestedatt--options--http_config--query_parameters))
- `skip_tls_verify` (Boolean) If enabled any certificate presented by the server and any host name in that certificate are accepted. In this mode, TLS is susceptible to machine-in-the-middle attacks.
- `timeout` (Number) Time limit for the request in seconds. Ignored for multipart requests with files as attachments. For non multipart requests is required Ignored for multipart requests with files as attachments otherwise required and must be between 1 and 120
- `username` (String)

<a id="nestedatt--options--http_config--headers"></a>
### Nested Schema for `options.http_config.headers`

Required:

- `key` (String)
- `value` (String)


<a id="nestedatt--options--http_config--parts"></a>
### Nested Schema for `options.http_config.parts`

Required:

- `name` (String)

Optional:

- `body` (String)
- `filepath` (String) Path to the file to be sent as an attachment.
- `headers` (Attributes List) (see [below for nested schema](#nestedatt--options--http_config--parts--headers))

<a id="nestedatt--options--http_config--parts--headers"></a>
### Nested Schema for `options.http_config.parts.headers`

Required:

- `key` (String)
- `value` (String)



<a id="nestedatt--options--http_config--query_parameters"></a>
### Nested Schema for `options.http_config.query_parameters`

Required:

- `key` (String)
- `value` (String)



<a id="nestedatt--options--icap_config"></a>
### Nested Schema for `options.icap_config`

Required:

- `endpoint` (String) ICAP endpoint in the format `schema://host:port`. Supported schemas: `icap`, `icaps`. If the port is omitted, port `1344` is used.
- `method` (String) ICAP method to use. Currently `REQMOD` is supported.
- `paths` (List of String) List of virtual paths to scan. Placeholders are supported, e.g. `{{.VirtualPath}}`.

Optional:

- `adapt_action` (Number) Action executed when the ICAP server returns a modified file.

Supported values:
* `1`: Ignore (keep original)
* `2`: Delete (reject)
* `3`: Quarantine
* `4`: Overwrite (use modified file)
- `block_action` (Number) Action executed when the ICAP server detects an infected file.

Supported values:
* `1`: Ignore (allow file)
* `2`: Delete (reject file)
* `3`: Quarantine
- `failure_policy` (Number) Action executed when the ICAP scan fails (e.g. server unreachable).

Supported values:
* `1`: Ignore (allow file)
* `2`: Delete (reject file)
* `3`: Quarantine
- `headers` (Attributes List) Headers to add to the ICAP request. (see [below for nested schema](#nestedatt--options--icap_config--headers))
- `quarantine_folder` (String) The name of the virtual folder where quarantined files will be stored.
- `quarantine_path` (String) The virtual path where quarantined files will be stored. Placeholders are supported.
- `skip_tls_verify` (Boolean) If enabled, any certificate presented by the server and any host name in that certificate are accepted. **Warning:** In this mode, TLS is susceptible to machine-in-the-middle attacks.
- `timeout` (Number) Timeout in seconds for ICAP requests.

<a id="nestedatt--options--icap_config--headers"></a>
### Nested Schema for `options.icap_config.headers`

Required:

- `key` (String)
- `value` (String)



<a id="nestedatt--options--idp_config"></a>
### Nested Schema for `options.idp_config`

Required:

- `mode` (Number) 0 means create or update the account, 1 means create the account if it doesn't exist.

Optional:

- `template_admin` (String) SFTPGo admin template in JSON format.
- `template_user` (String) SFTPGo user template in JSON format.


<a id="nestedatt--options--imap_config"></a>
### Nested Schema for `options.imap_config`

Required:

- `endpoint` (String) IMAP endpoint in the format `schema://host:port`. Supported schemas: `imap`, `imaps`.

Optional:

- `auth_type` (Number) Authentication type.

Supported values:
* `0`: Login
* `1`: Plain
- `mailbox` (String) Mailbox to check, e.g. `INBOX`.
- `oauth2` (Attributes) (see [below for nested schema](#nestedatt--options--imap_config--oauth2))
- `password` (String, Sensitive) SFTPGo secret formatted as string: "$<status>$<key>$<additional data length>$<additional data><payload>".
- `path` (String) Directory path where downloaded attachments will be stored.
- `post_process_action` (Number) Action to perform on the email after processing.

Supported values:
* `0`: Mark messages as read
* `1`: Delete messages
- `target_folder` (String) If specified, attachments are stored directly in this target virtual folder. If not specified, attachments are downloaded to the user account associated with the action.

**Note:** IMAP actions are executed for a single user only, so a target folder or an appropriate filter in the related rule is recommended.
- `username` (String)

<a id="nestedatt--options--imap_config--oauth2"></a>
### Nested Schema for `options.imap_config.oauth2`

Optional:

- `client_id` (String) OAuth2 Client ID.
- `client_secret` (String, Sensitive) SFTPGo secret formatted as string: "$<status>$<key>$<additional data length>$<additional data><payload>".
- `provider` (Number) OAuth2 Provider.

Supported values:
* `0`: Google
* `1`: Microsoft
- `refresh_token` (String, Sensitive) SFTPGo secret formatted as string: "$<status>$<key>$<additional data length>$<additional data><payload>".
- `tenant` (String) OAuth2 Tenant.



<a id="nestedatt--options--pwd_expiration_config"></a>
### Nested Schema for `options.pwd_expiration_config`

Required:

- `threshold` (Number) An email notification will be generated for users whose password expires in a number of days less than or equal to this threshold.


<a id="nestedatt--options--retention_config"></a>
### Nested Schema for `options.retention_config`

Optional:

- `archive_folder` (String) Virtual folder name. If set, files will be moved there instead of being deleted. Available in the Enterprise edition.
- `archive_path` (String) The base path where archived files will be stored. Placeholders are supported. Available in the Enterprise edition.
- `folders` (Attributes List) Folders to apply data retention rules to. (see [below for nested schema](#nestedatt--options--retention_config--folders))

<a id="nestedatt--options--retention_config--folders"></a>
### Nested Schema for `options.retention_config.folders`

Required:

- `path` (String) Path for which to apply the retention rules.
- `retention` (Number) Retention as hours. 0 as retention means excluding the specified path.

Optional:

- `delete_empty_dirs` (Boolean) If enabled, empty directories will be deleted.



<a id="nestedatt--options--share_expiration_config"></a>
### Nested Schema for `options.share_expiration_config`

Optional:

- `advance_notice` (Number) Number of days before the share expiration (real or calculated) to trigger the expiration event. Set to 0 to disable.
- `grace_period` (Number) Number of days a share is kept in the database after it has expired. Set to 0 to disable share deletion.
- `inactivity_threshold` (Number) Validity period (in days) for shares without an explicit expiration date. Checks last use or creation time. Set to 0 to disable.
- `split_events` (Boolean) If true, events are split. For example, email actions will send a separate notification for each share instead of a cumulative report.


<a id="nestedatt--options--user_inactivity_config"></a>
### Nested Schema for `options.user_inactivity_config`

Optional:

- `delete_threshold` (Number) Inactivity in days, since the last login before deleting the account.
- `disable_threshold` (Number) Inactivity in days, since the last login before disabling the account.
